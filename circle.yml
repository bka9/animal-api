machine:
  services:
    - docker

dependencies:
  pre:
    - docker info
    - docker build -t bka9/animalapi:$CIRCLE_SHA1 .

test:
  override:
    - export CID=$(docker run -d -p 3000:3000 bka9/animalapi:$CIRCLE_SHA1 sbt run); sleep 10; curl --retry 10 --retry-delay 5 -v http://$(docker inspect --format '{{ .NetworkSettings.IPAddress }}' $CID):3000;
